name = "danmu-api"
main = "cf_worker.js"
compatibility_date = "2024-09-21"


# 基础环境变量（公开配置）
[vars]
ENABLE_ASYMMETRIC_AUTH_ENV = "false"
ENABLE_DETAILED_LOGGING = "true"
USER_AGENT_LIMITS_CONFIG = '''{{USER_AGENT_LIMITS_CONFIG}}'''
IP_BLACKLIST_CONFIG = '''{{IP_BLACKLIST_CONFIG}}'''
TG_BOT_TOKEN = '''{{TG_BOT_TOKEN}}'''
TG_ADMIN_USER_ID = '''{{TG_ADMIN_USER_ID}}'''
WORKER_DOMAIN = '''{{WORKER_DOMAIN}}'''
CLOUDFLARE_WORKER_NAME = '''{{CLOUDFLARE_WORKER_NAME}}'''
#密钥配置 （一般有两个，两个都填会轮换使用，配置成密钥的类型）
# APP_ID
# APP_SECRET
# APP_SECRET_2
# CLOUDFLARE_API_TOKEN (密钥类型)
# CLOUDFLARE_ACCOUNT_ID (密钥类型)


# wrangler.toml (wrangler v3.88.0^)
[observability.logs]
enabled = true

# Durable Object 绑定配置
[durable_objects]
bindings = [
  { name = "RATE_LIMITER", class_name = "RateLimiter" },
  { name = "APP_STATE", class_name = "AppState" }
]

[[migrations]]
tag = "v6" # 添加AppState，不触碰已存在的RateLimiter
new_sqlite_classes = ["AppState"]
